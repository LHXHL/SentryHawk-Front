import{Z as r,d as y,i as m,r as n,g as z,o as O,w as a,b as i,u as k,x as D,e as w,a3 as g,a as v,t as I}from"./index-Bj5Pylhr.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j=async(x,c,f={},_=!0,s=".xlsx")=>{_&&r({title:"温馨提示",message:"如果数据庞大会导致下载缓慢哦，请您耐心等待！",type:"info",duration:3e3});try{const e=await x(f),p=new Blob([e]);if("msSaveOrOpenBlob"in navigator)return window.navigator.msSaveOrOpenBlob(p,c+s);const d=window.URL.createObjectURL(p),o=document.createElement("a");o.style.display="none",o.download=`${c}${s}`,o.href=d,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(d)}catch{}},A={class:"el-upload__tip"},F=y({name:"ImportExcel"}),N=y({...F,setup(x,{expose:c}){const f=m(!1),_=m(1),s=m(!1),e=m({title:"",fileSize:5,fileType:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]}),p=l=>{e.value={...e.value,...l},s.value=!0},d=()=>{e.value.tempApi&&j(e.value.tempApi,`${e.value.title}模板`)},o=async l=>{let t=new FormData;t.append("file",l.file),t.append("isCover",f.value),await e.value.importApi(t),e.value.getTableList&&e.value.getTableList(),s.value=!1},S=l=>{const t=e.value.fileType.includes(l.type),u=l.size/1024/1024<e.value.fileSize;return t||r({title:"温馨提示",message:"上传文件只能是 xls / xlsx 格式！",type:"warning"}),u||setTimeout(()=>{r({title:"温馨提示",message:`上传文件大小不能超过 ${e.value.fileSize}MB！`,type:"warning"})},0),t&&u},C=()=>{r({title:"温馨提示",message:"最多只能上传一个文件！",type:"warning"})},E=()=>{r({title:"温馨提示",message:`批量添加${e.value.title}失败，请您重新上传！`,type:"error"})},U=()=>{r({title:"温馨提示",message:`批量添加${e.value.title}成功！`,type:"success"})};return c({acceptParams:p}),(l,t)=>{const u=n("el-button"),b=n("el-form-item"),$=n("upload-filled"),h=n("el-icon"),B=n("el-upload"),L=n("el-form"),T=n("el-dialog");return O(),z(T,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=V=>s.value=V),title:`批量添加${e.value.title}`,"destroy-on-close":!0,width:"580px",draggable:""},{default:a(()=>[i(L,{class:"drawer-multiColumn-form","label-width":"100px"},{default:a(()=>[i(b,{label:"模板下载 :"},{default:a(()=>[i(u,{type:"primary",icon:k(D),onClick:d},{default:a(()=>t[1]||(t[1]=[w(" 点击下载 ")])),_:1},8,["icon"])]),_:1}),i(b,{label:"文件上传 :"},{default:a(()=>[i(B,{action:"#",class:"upload",drag:!0,limit:_.value,multiple:!0,"show-file-list":!0,"http-request":o,"before-upload":S,"on-exceed":C,"on-success":U,"on-error":E,accept:e.value.fileType.join(",")},{tip:a(()=>[g(l.$slots,"tip",{},()=>[v("div",A,"请上传 .xls , .xlsx 标准格式文件，文件最大为 "+I(e.value.fileSize)+"M",1)],!0)]),default:a(()=>[g(l.$slots,"empty",{},()=>[i(h,{class:"el-icon--upload"},{default:a(()=>[i($)]),_:1}),t[2]||(t[2]=v("div",{class:"el-upload__text"},[w("将文件拖到此处，或"),v("em",null,"点击上传")],-1))],!0)]),_:3},8,["limit","accept"])]),_:3})]),_:3})]),_:3},8,["modelValue","title"])}}}),P=R(N,[["__scopeId","data-v-b32a8c0d"]]);export{P as I,j as u};
