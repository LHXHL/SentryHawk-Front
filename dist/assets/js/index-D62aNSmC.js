import{z as d,d as D,l as q,i as w,m as $,b as r,r as m,e as o,F as J,A as z,c as G,o as g,w as n,u,v as W,n as j,at as K,p as L,y as b,t as k,B as T,g as C,q as Q,s as X,x as Z,E as ee}from"./index-BgQJFBPu.js";import{u as y}from"./useHandleData-BB-JcKBl.js";import{I as te,u as ae}from"./index-BytUOJQ_.js";import{u as re}from"./useAuthButtons-Dj_8VRCX.js";import{_ as se}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-pCjZw6mf.js";import{P as p,_ as le}from"./UserDrawer.vue_vue_type_script_setup_true_name_UserDrawer_lang-tQipqhw1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./sortable.esm-C83syoBY.js";const ne=s=>d.post(p+"/user/list",s),oe=s=>d.post(p+"/user/add",s),ie=s=>d.post(p+"/user/import",s),ue=s=>d.post(p+"/user/edit",s),U=s=>d.post(p+"/user/delete",s),de=s=>d.post(p+"/user/change",s),pe=s=>d.post(p+"/user/rest_password",s),A=s=>d.download(p+"/user/export",s),ce=()=>d.get(p+"/user/status"),me=()=>d.get(p+"/user/gender"),fe={class:"table-box"},be=D({name:"useProTable"}),$e=D({...be,setup(s){const S=q(),h=()=>{S.push(`/proTable/useProTable/detail/${Math.random().toFixed(3)}?params=detail-page`)},i=w(),V=$({type:1}),B=t=>({list:t.list,total:t.total}),E=t=>{let e=JSON.parse(JSON.stringify(t));return e.createTime&&(e.startTime=e.createTime[0]),e.createTime&&(e.endTime=e.createTime[1]),delete e.createTime,ne(e)},{BUTTONS:F}=re(),P=$([{type:"selection",fixed:"left",width:70},{type:"sort",label:"Sort",width:80},{type:"expand",label:"Expand",width:85},{prop:"username",label:"用户姓名",search:{el:"input",tooltip:"我是搜索提示"},render:t=>r(m("el-button"),{type:"primary",link:!0,onClick:()=>b.success("我是通过 tsx 语法渲染的内容")},{default:()=>[t.row.username]})},{prop:"gender",label:"性别",enum:me,search:{el:"select",props:{filterable:!0}},fieldNames:{label:"genderLabel",value:"genderValue"}},{prop:"user.detail.age",label:"年龄",search:{render:({searchParam:t})=>r("div",{class:"flx-center"},[r(m("el-input"),{modelValue:t.minAge,modelModifiers:{trim:!0},"onUpdate:modelValue":e=>t.minAge=e,placeholder:"最小年龄"},null),r("span",{class:"mr10 ml10"},[o("-")]),r(m("el-input"),{modelValue:t.maxAge,modelModifiers:{trim:!0},"onUpdate:modelValue":e=>t.maxAge=e,placeholder:"最大年龄"},null)])}},{prop:"idCard",label:"身份证号",search:{el:"input"}},{prop:"email",label:"邮箱"},{prop:"address",label:"居住地址"},{prop:"status",label:"用户状态",enum:ce,search:{el:"tree-select",props:{filterable:!0}},fieldNames:{label:"userLabel",value:"userStatus"},render:t=>r(J,null,[F.value.status?r(m("el-switch"),{"model-value":t.row.status,"active-text":t.row.status?"启用":"禁用","active-value":1,"inactive-value":0,onClick:()=>I(t.row)},null):r(m("el-tag"),{type:t.row.status?"success":"danger"},{default:()=>[t.row.status?"启用":"禁用"]})])},{prop:"createTime",label:"创建时间",headerRender:t=>r(m("el-button"),{type:"primary",onClick:()=>b.success("我是通过 tsx 语法渲染的表头")},{default:()=>[t.column.label]}),width:180,search:{el:"date-picker",span:2,props:{type:"datetimerange",valueFormat:"YYYY-MM-DD HH:mm:ss"},defaultValue:["2022-11-12 11:35:00","2022-12-12 11:35:00"]}},{prop:"operation",label:"操作",fixed:"right",width:330}]),R=({newIndex:t,oldIndex:e})=>{var a;(a=i.value)==null||a.tableData,b.success("修改列表排序成功")},M=async t=>{var e;await y(U,{id:[t.id]},`删除【${t.username}】用户`),(e=i.value)==null||e.getTableList()},N=async t=>{var e,a;await y(U,{id:t},"删除所选用户信息"),(e=i.value)==null||e.clearSelection(),(a=i.value)==null||a.getTableList()},H=async t=>{var e;await y(pe,{id:t.id},`重置【${t.username}】用户密码`),(e=i.value)==null||e.getTableList()},I=async t=>{var e;await y(de,{id:t.id,status:t.status==1?0:1},`切换【${t.username}】用户状态`),(e=i.value)==null||e.getTableList()},O=async()=>{ee.confirm("确认导出用户数据?","温馨提示",{type:"warning"}).then(()=>{var t;return ae(A,"用户列表",(t=i.value)==null?void 0:t.searchParam)})},_=w(null),Y=()=>{var e,a;const t={title:"用户",tempApi:A,importApi:ie,getTableList:(e=i.value)==null?void 0:e.getTableList};(a=_.value)==null||a.acceptParams(t)},x=w(null),v=(t,e={})=>{var f,l;const a={title:t,isView:t==="查看",row:{...e},api:t==="新增"?oe:t==="编辑"?ue:void 0,getTableList:(f=i.value)==null?void 0:f.getTableList};(l=x.value)==null||l.acceptParams(a)};return(t,e)=>{const a=m("el-button"),f=z("auth");return g(),G("div",fe,[r(se,{ref_key:"proTable",ref:i,columns:P,"request-api":E,"init-param":V,"data-callback":B,onDragSort:R},{tableHeader:n(l=>[T((g(),C(a,{type:"primary",icon:u(Q),onClick:e[0]||(e[0]=c=>v("新增"))},{default:n(()=>e[3]||(e[3]=[o("新增用户")])),_:1},8,["icon"])),[[f,"add"]]),T((g(),C(a,{type:"primary",icon:u(X),plain:"",onClick:Y},{default:n(()=>e[4]||(e[4]=[o("批量添加用户")])),_:1},8,["icon"])),[[f,"batchAdd"]]),T((g(),C(a,{type:"primary",icon:u(Z),plain:"",onClick:O},{default:n(()=>e[5]||(e[5]=[o("导出用户数据")])),_:1},8,["icon"])),[[f,"export"]]),r(a,{type:"primary",plain:"",onClick:h},{default:n(()=>e[6]||(e[6]=[o("To 子集详情页面")])),_:1}),r(a,{type:"danger",icon:u(L),plain:"",disabled:!l.isSelected,onClick:c=>N(l.selectedListIds)},{default:n(()=>e[7]||(e[7]=[o(" 批量删除用户 ")])),_:2},1032,["icon","disabled","onClick"])]),expand:n(l=>[o(k(l.row),1)]),usernameHeader:n(l=>[r(a,{type:"primary",onClick:e[1]||(e[1]=c=>u(b).success("我是通过作用域插槽渲染的表头"))},{default:n(()=>[o(k(l.column.label),1)]),_:2},1024)]),createTime:n(l=>[r(a,{type:"primary",link:"",onClick:e[2]||(e[2]=c=>u(b).success("我是通过作用域插槽渲染的内容"))},{default:n(()=>[o(k(l.row.createTime),1)]),_:2},1024)]),operation:n(l=>[r(a,{type:"primary",link:"",icon:u(W),onClick:c=>v("查看",l.row)},{default:n(()=>e[8]||(e[8]=[o("查看")])),_:2},1032,["icon","onClick"]),r(a,{type:"primary",link:"",icon:u(j),onClick:c=>v("编辑",l.row)},{default:n(()=>e[9]||(e[9]=[o("编辑")])),_:2},1032,["icon","onClick"]),r(a,{type:"primary",link:"",icon:u(K),onClick:c=>H(l.row)},{default:n(()=>e[10]||(e[10]=[o("重置密码")])),_:2},1032,["icon","onClick"]),r(a,{type:"primary",link:"",icon:u(L),onClick:c=>M(l.row)},{default:n(()=>e[11]||(e[11]=[o("删除")])),_:2},1032,["icon","onClick"])]),_:1},8,["columns","init-param"]),r(le,{ref_key:"drawerRef",ref:x},null,512),r(te,{ref_key:"dialogRef",ref:_},null,512)])}}});export{$e as default};
